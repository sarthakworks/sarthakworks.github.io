import{u as I,b as R,r,j as e}from"./index-CUU7AGCI.js";import{g as G,p as $,G as _}from"./pdf.worker.min-DHeGPavo.js";import{P as K}from"./PDFButton-CfUEN3nP.js";import{C as W}from"./Card-BzAKe0rG.js";_.workerSrc=$;const Q=()=>{const{t:x}=I(),l=R(),[i,g]=r.useState(null),[b,j]=r.useState(!1),[p,h]=r.useState("recommended"),[w,u]=r.useState(null),[c,y]=r.useState(0),[N,v]=r.useState(0);r.useEffect(()=>{l.state&&l.state.file&&(g(l.state.file),y(l.state.file.size))},[l.state]);const C=[{id:"extreme",label:"Extreme Compression",desc:"Less quality, high compression",quality:.1,scale:1},{id:"recommended",label:"Recommended Compression",desc:"Good quality, good compression",quality:.5,scale:1.5},{id:"less",label:"Less Compression",desc:"High quality, less compression",quality:.8,scale:2}],S=s=>{const a=s.target.files[0];a&&a.type==="application/pdf"?(g(a),y(a.size),u(null),v(0)):alert("Please select a valid PDF file.")},k=async()=>{if(i){j(!0),u(null);try{const s=C.find(o=>o.id===p),a=await i.arrayBuffer(),n=await G(a).promise,d=n.numPages,f=await K.create();for(let o=1;o<=d;o++){const D=await n.getPage(o),t=D.getViewport({scale:s.scale}),m=document.createElement("canvas"),L=m.getContext("2d");m.height=t.height,m.width=t.width;const q={canvasContext:L,viewport:t};await D.render(q).promise;const E=m.toDataURL("image/jpeg",s.quality),M=await fetch(E).then(U=>U.arrayBuffer()),O=await f.embedJpg(M);f.addPage([t.width,t.height]).drawImage(O,{x:0,y:0,width:t.width,height:t.height})}const z=await f.save(),F=new Blob([z],{type:"application/pdf"}),B=URL.createObjectURL(F);v(F.size),u(B)}catch(s){console.error("Error compressing PDF:",s),alert("An error occurred during compression.")}finally{j(!1)}}},P=s=>{if(s===0)return"0 B";const a=1024,n=["B","KB","MB","GB"],d=Math.floor(Math.log(s)/Math.log(a));return parseFloat((s/Math.pow(a,d)).toFixed(2))+" "+n[d]};return e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"page-title-box",children:e.jsx("h4",{className:"page-title",children:x("compress_pdf")||"Compress PDF"})})})}),e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"col-lg-8",children:e.jsxs(W,{title:x("compress_pdf")||"Compress PDF",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"pdf-upload",className:"form-label",children:"Select PDF File"}),e.jsx("input",{className:"form-control",type:"file",id:"pdf-upload",accept:"application/pdf",onChange:S}),c>0&&e.jsxs("div",{className:"mt-2 text-muted",children:["Original Size: ",P(c)]})]}),e.jsxs("div",{className:"mb-4",role:"radiogroup","aria-labelledby":"compression-level-label",children:[e.jsx("span",{id:"compression-level-label",className:"form-label mb-3 d-block",children:"Compression Level"}),e.jsx("div",{className:"row g-3",children:C.map(s=>e.jsx("div",{className:"col-md-4",children:e.jsx("div",{role:"button",tabIndex:0,className:`card h-100 cursor-pointer border ${p===s.id?"border-primary bg-light":""}`,onClick:()=>h(s.id),onKeyDown:a=>{(a.key==="Enter"||a.key===" ")&&h(s.id)},style:{cursor:"pointer"},children:e.jsxs("div",{className:"card-body text-center p-3",children:[e.jsx("div",{className:"form-check d-flex justify-content-center mb-2",children:e.jsx("input",{className:"form-check-input",type:"radio",name:"compressionLevel",id:`compression-option-${s.id}`,checked:p===s.id,onChange:()=>h(s.id),style:{cursor:"pointer"},tabIndex:-1})}),e.jsx("label",{className:"card-title fw-bold mb-1 d-block",htmlFor:`compression-option-${s.id}`,style:{cursor:"pointer"},children:s.label}),e.jsx("p",{className:"card-text small text-muted mb-0",children:s.desc})]})},s.id)},s.id))})]}),e.jsx("button",{className:"btn btn-primary w-100 fw-bold py-2",onClick:k,disabled:!i||b,children:b?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Compressing PDF..."]}):"Compress PDF"}),w&&e.jsxs("div",{className:"mt-4 p-3 bg-light rounded border text-center",children:[e.jsx("h5",{className:"text-success mb-2",children:"Compression Complete!"}),e.jsxs("p",{className:"mb-3",children:["New Size: ",e.jsx("strong",{children:P(N)})," ",e.jsxs("span",{className:"text-success",children:["(",Math.round((c-N)/c*100),"% smaller)"]})]}),e.jsxs("a",{href:w,download:`compressed_${i.name}`,className:"btn btn-success fw-bold",children:[e.jsx("i",{className:"mdi mdi-download me-1"})," Download Compressed PDF"]})]})]})})})]})};export{Q as default};
