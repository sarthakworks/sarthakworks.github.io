import{u as L,r as p,j as e}from"./index-CUU7AGCI.js";import{P as U}from"./PDFButton-CfUEN3nP.js";import{C as k}from"./Card-BzAKe0rG.js";const A=()=>{const{t:u}=L(),[r,d]=p.useState([]),[b,v]=p.useState(!1),[j,i]=p.useState(null),[c,w]=p.useState(null),N=a=>{const t=Array.from(a.target.files),s=t.filter(l=>l.type.startsWith("image/"));if(s.length<t.length&&alert("Some selected files were not images and will be ignored."),s.length>0){const l=s.map(n=>({id:Math.random().toString(36).substr(2,9),file:n,preview:URL.createObjectURL(n)}));d(n=>[...n,...l]),i(null)}},y=a=>{d(t=>t.filter((s,l)=>l!==a)),i(null)},g=(a,t)=>{if(t===-1&&a===0||t===1&&a===r.length-1)return;const s=[...r],l=s[a];s[a]=s[a+t],s[a+t]=l,d(s),i(null)},D=(a,t)=>{w(t),a.dataTransfer.effectAllowed="move"},I=a=>{a.preventDefault(),a.dataTransfer.dropEffect="move"},P=(a,t)=>{if(a.preventDefault(),c===null||c===t)return;const s=[...r],l=s[c];s.splice(c,1),s.splice(t,0,l),d(s),w(null),i(null)},C=async()=>{if(r.length!==0){v(!0),i(null);try{const a=await U.create();for(const n of r){const x=await n.file.arrayBuffer();let o;if(n.file.type==="image/jpeg")o=await a.embedJpg(x);else if(n.file.type==="image/png")o=await a.embedPng(x);else{const h=document.createElement("canvas"),S=h.getContext("2d"),m=new Image;m.src=n.preview,await new Promise(f=>m.onload=f),h.width=m.width,h.height=m.height,S.drawImage(m,0,0);const R=h.toDataURL("image/jpeg",.9),F=await fetch(R).then(f=>f.arrayBuffer());o=await a.embedJpg(F)}a.addPage([o.width,o.height]).drawImage(o,{x:0,y:0,width:o.width,height:o.height})}const t=await a.save(),s=new Blob([t],{type:"application/pdf"}),l=URL.createObjectURL(s);i(l)}catch(a){console.error("Error converting images to PDF:",a),alert("An error occurred during conversion.")}finally{v(!1)}}};return e.jsxs("div",{className:"container-fluid",children:[e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"page-title-box",children:e.jsx("h4",{className:"page-title",children:u("image_to_pdf")||"Image to PDF"})})})}),e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"col-lg-8",children:e.jsxs(k,{title:u("image_to_pdf")||"Image to PDF",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"image-upload",className:"form-label",children:"Select Images"}),e.jsx("input",{className:"form-control",type:"file",id:"image-upload",accept:"image/*",multiple:!0,onChange:N}),e.jsx("p",{className:"text-muted small mt-1",children:"Supported formats: JPG, PNG. Others will be converted automatically."})]}),r.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("h6",{className:"mb-3",children:["Selected Images (",r.length,")"]}),e.jsx("div",{className:"row g-2",children:r.map((a,t)=>e.jsx("div",{className:"col-6 col-md-3",draggable:!0,role:"listitem","aria-label":`Page ${t+1}`,tabIndex:0,onDragStart:s=>D(s,t),onDragOver:I,onDrop:s=>P(s,t),style:{opacity:c===t?.4:1,cursor:"move",transition:"opacity 0.2s",outline:"none"},onKeyDown:s=>{s.key==="ArrowLeft"&&g(t,-1),s.key==="ArrowRight"&&g(t,1)},children:e.jsxs("div",{className:"card h-100 shadow-sm border position-relative",children:[e.jsx("div",{className:"position-absolute top-0 start-0 p-1 bg-white rounded-bottom-end shadow-sm",style:{zIndex:10,fontSize:"0.8rem",fontWeight:"bold"},children:t+1}),e.jsx("img",{src:a.preview,alt:`Page ${t+1}`,className:"card-img-top object-fit-cover",style:{height:"120px",pointerEvents:"none"}}),e.jsxs("div",{className:"card-body p-2 d-flex justify-content-between align-items-center bg-light",children:[e.jsxs("div",{children:[e.jsx("button",{className:"btn btn-sm btn-outline-secondary me-1 p-0 px-1",onClick:()=>g(t,-1),disabled:t===0,title:"Move Left","aria-label":"Move Left",children:e.jsx("i",{className:"mdi mdi-chevron-left"})}),e.jsx("button",{className:"btn btn-sm btn-outline-secondary p-0 px-1",onClick:()=>g(t,1),disabled:t===r.length-1,title:"Move Right","aria-label":"Move Right",children:e.jsx("i",{className:"mdi mdi-chevron-right"})})]}),e.jsx("button",{className:"btn btn-sm btn-outline-danger p-0 px-1",onClick:()=>y(t),title:"Remove","aria-label":"Remove",children:e.jsx("i",{className:"mdi mdi-delete"})})]})]})},a.id||t))})]}),e.jsx("button",{className:"btn btn-primary w-100 fw-bold py-2",onClick:C,disabled:r.length===0||b,children:b?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"}),"Converting..."]}):"Convert to PDF"}),j&&e.jsxs("div",{className:"mt-4 p-3 bg-light rounded border text-center",children:[e.jsx("h5",{className:"text-success mb-2",children:"Conversion Complete!"}),e.jsxs("a",{href:j,download:"images_converted.pdf",className:"btn btn-success fw-bold",children:[e.jsx("i",{className:"mdi mdi-download me-1"})," Download PDF"]})]})]})})})]})};export{A as default};
